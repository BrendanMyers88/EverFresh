{% extends 'base.html' %}

{% block content %}

    <!-- CSS -->
    <style>
        #qty_id {
            text-align: right;
        }

        h1 {
            alignment: center;
        }

        #product_name {
            font-weight: normal;
        }

        .food_item_row:hover {
            background-color: #f9f9f9;
            cursor: pointer;
        }

        .item.ui.segment:hover {
            background-color: #f1f1f1;
            cursor: pointer;
        }

        input#qty_id:focus {
            background-color: rgba(0, 255, 28, 0.06);
            border-color: rgba(41, 67, 32, 0.44);
        }

        .ui.form {
            margin-bottom: 10px;
        }
    </style>
    <!--Page Title-->
    <h1> {{ freshsheet.created_at }} Fresh Sheet </h1>


    <!--List View-->
    <form method="post" action="{% url "add_line_items_to_cart" %}" class="ui form">
        {% csrf_token %}
        <table class="ui compact celled definition table">
            <thead class="full-width">
            <tr>
                <th class="ten wide left aligned">Product</th>
                <th class="four wide right aligned">Quantity</th>
                <th class="two wide right aligned">Price Per Unit</th>
            </tr>
            </thead>
            <tbody>
            {% for food_item in freshsheet.items.all|dictsort:"name" %}
                <tr onclick="$(this).find('input').focus()" class="food_item_row">
                    <td id="product_name">
                        {{ food_item.name }}
                    </td>
                    <td class="right aligned">
                                        <div class="field">
                                            <div class="ui fluid right labeled input">
                                                <input title="quantity" name="quantity_{{ food_item.pk }}" type="number"
                                                       min="1"
                                                       max="9999" class="right aligned"
                                                       placeholder="0">
                                                <div style="width: 5em;" class="ui right aligned basic label">
                                                    {{ food_item.get_unit_verbose }}
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                    <td class="right aligned">${{ food_item.price }}</td>
                </tr>
            {% endfor %}
            </tbody>
            <tfoot class="full-width">
            <tr>
                <th></th>
                <th></th>
                <th>
                    <button value="{{ line.pk }}" id="add_items" class="tiny ui green fluid button">
                        Add to Cart
                    </button>
                </th>
            </tr>
            </tfoot>
        </table>
    </form>

    <script>

        $(document).ready(function () {
            $(".order-button").click(function (event) {
                // your add_quantity function stuff here
                var quantity = $(event.target).parent().find('input').val()
                $.get("/add_to_cart/" + this.dataset.itemId + "/" + quantity + "/" + "?freshsheet_pk={{ freshsheet.pk }}")
            })
        });
    </script>
{% endblock %}
